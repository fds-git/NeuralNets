### Проект обучения нейронной сети для распознавания лиц


- face_recognition.ipynb - ноутбук с обучением сети, валидацией и ее сохранением
- mobile_emb128_0.26test_margin2_122000own - сохраненные веса модели, обученной на большом датасете
- mobile_emb128_0.28test_margin2_77000mtcnn - сохраненные веса модели, обученной на малом датасете


Порядок работы:
1. Сначала обучался на тестовом датасете (тренировочный не нашел) VGGFace2 - 170000 изображений людей
   недостаток - изображения неразмечены (нет координат bbox'ов)
   достоинства - изображения не надо скачивать по отдельности по ссылкам (нашел сразу папку)
                 в папке с изображениями конкретного человека нет изображений другого человека - данные
                 не надо чистить

   после выделения лиц с помощью MTCNN (выделялись только лица, исходный размер которых был больше 100х100),
   папка с лицами стала содержать 58000 изображений
   результатом стала точность на тесте 0.25 за 3 эпохи. Такая же точность была достигнута за 3 эпохи, когда 
   выделялись лица с исходным размером 150х150 - тогда папка с лицами содержала 27000 изображений
   на лицо - переобучение, связанное с тем, что всего было 500 уникальных людей
   все эти эксперименты проводились с margin для triplet loss = 1
2. Далее был скачан датасет VGGFace1, который представляет из себя 2600 текстовых файлов (по одному на
   отдельного человека), каждый из которых содержит 1000 ссылок на изображение человека
   недостатки - нужно скачивать долго данные - 6 часов - 1000 человек по 400 изображений
                в результате скачалось только 225000 изображений, так как некоторые ссылки битые,
                иногда загружались изображения других людей или невалидные картинки
   достоинства - есть координаты bbox'ов
                 данных в итоге получилось больше, чем у test VGGFace2
   выделение лиц происходило двумя способами: через mtcnn и с помощью предоставленных bbox'ов
   в первом случае получился датасет из 77000 изображений лиц (исходный размер больше 100х100)
   во втором - из 122000. Это произошло из-за того, что алгоритм выделения лиц с помощью mtcnn
   отбраковывал изображения, на которых присутствуют несколько человек, плюс еще есть дополнительные фильтры
   лучше использовать второй метод, если нужно больше данных. если мало времени, используем первый метод.
   В обоих случаях результат на тесте - 0.14 для triplet loss = 1
3. Далее проведены эксперименты для triplet loss = 2
   при обучении и на 77000 и на 122000 датасетах результат на test был приблизительно равен 0.3 за 5 эпох. 
   Этот результат должен быть достаточен для решения поставленной задачи